"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3358],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),u=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},c=function(e){var t=u(e.components);return a.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},s=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,p=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),s=u(n),m=r,f=s["".concat(p,".").concat(m)]||s[m]||d[m]||o;return n?a.createElement(f,l(l({ref:t},c),{},{components:n})):a.createElement(f,l({ref:t},c))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,l=new Array(o);l[0]=s;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i.mdxType="string"==typeof e?e:r,l[1]=i;for(var u=2;u<o;u++)l[u]=n[u];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}s.displayName="MDXCreateElement"},9194:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>p,default:()=>m,frontMatter:()=>i,metadata:()=>u,toc:()=>d});var a=n(7462),r=n(3366),o=(n(7294),n(3905)),l=["components"],i={id:"bundle",title:"Bundle",sidebar_position:7},p=void 0,u={unversionedId:"concepts/bundle",id:"concepts/bundle",title:"Bundle",description:"Bundles allow you to select components, reducers and actions common for different pages.",source:"@site/tmp-docs/concepts/bundle.md",sourceDirName:"concepts",slug:"/concepts/bundle",permalink:"/tramvai/docs/concepts/bundle",draft:!1,editUrl:"https://github.com/Tinkoff/tramvai/-/edit/master/docs/get-started/overview.md/tmp-docs/concepts/bundle.md",tags:[],version:"current",sidebarPosition:7,frontMatter:{id:"bundle",title:"Bundle",sidebar_position:7},sidebar:"sidebar",previous:{title:"Action",permalink:"/tramvai/docs/concepts/action"},next:{title:"Versioning",permalink:"/tramvai/docs/concepts/versioning"}},c={},d=[{value:"Dynamic bundle import",id:"dynamic-bundle-import",level:2},{value:"Default bundle",id:"default-bundle",level:2},{value:"Create a bundle",id:"create-a-bundle",level:4},{value:"Connect the bundle",id:"connect-the-bundle",level:4}],s={toc:d};function m(e){var t=e.components,n=(0,r.Z)(e,l);return(0,o.kt)("wrapper",(0,a.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Bundles allow you to select components, reducers and actions common for different pages.\nBundles are registered for the entire application, the name of the current bundle is taken from the current route, if they match, the application initializes the bundle:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"searches in the bundle for components that match the ",(0,o.kt)("inlineCode",{parentName:"li"},"pageComponent")," and ",(0,o.kt)("inlineCode",{parentName:"li"},"layoutComponent")," from the route, saves them to the general case of components, then these components are used by the ",(0,o.kt)("inlineCode",{parentName:"li"},"RenderModule")," when rendering the page"),(0,o.kt)("li",{parentName:"ul"},"saves actions to the general action register"),(0,o.kt)("li",{parentName:"ul"},"registers new reducers")),(0,o.kt)("p",null,"Interface details ",(0,o.kt)("a",{parentName:"p",href:"/tramvai/docs/references/tramvai/core#createBundle"},"createBundle")),(0,o.kt)("h2",{id:"dynamic-bundle-import"},"Dynamic bundle import"),(0,o.kt)("p",null,"To highlight unnecessary code on each page, each bundle passed to ",(0,o.kt)("inlineCode",{parentName:"p"},"createApp")," must have the signature ",(0,o.kt)("inlineCode",{parentName:"p"},"() => Promise<{default: Bundle}>"),". All the code shared with the modules plugged into the application will remain in the main chunk of the application, and many bundles will weigh only a few KB, but as soon as one of the components of the bundle includes a heavy dependency, for example, a library with forms, it will completely fall into the corresponding bundle."),(0,o.kt)("p",null,"It is recommended to use ",(0,o.kt)("a",{parentName:"p",href:"https://webpack.js.org/guides/code-splitting/#dynamic-imports"},"dynamic import")," with the magic comment ",(0,o.kt)("inlineCode",{parentName:"p"},"webpackChunkName")," to specify the name of the new chunk, for example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"() => import(/* webpackChunkName: \"mainDefault\" */ './bundles/mainDefault')\n")),(0,o.kt)("h2",{id:"default-bundle"},"Default bundle"),(0,o.kt)("p",null,"Each route must have properties ",(0,o.kt)("inlineCode",{parentName:"p"},"bundle")," with the name of the bundle, ",(0,o.kt)("inlineCode",{parentName:"p"},"pageComponent")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"layoutComponent")," with the names of the corresponding components.\nThe default values \u200b\u200bare as follows:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"bundle: 'mainDefault'")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"pageComponent: 'pageDefault'")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"layoutComponent: 'layoutDefault'"))),(0,o.kt)("p",null,"When using the standard ",(0,o.kt)("inlineCode",{parentName:"p"},"RenderModule"),", the ",(0,o.kt)("inlineCode",{parentName:"p"},"LayoutModule")," is included, which will provide the ",(0,o.kt)("inlineCode",{parentName:"p"},"layoutDefault")," and a separate mechanism for extending and overriding layout in the application, so there is no need to add the ",(0,o.kt)("inlineCode",{parentName:"p"},"layoutDefault")," property to the ",(0,o.kt)("inlineCode",{parentName:"p"},"components")," list of the bundle."),(0,o.kt)("p",null,"To create a bundle that will run on all application pages that do not have specific route settings, two steps are enough:"),(0,o.kt)("h4",{id:"create-a-bundle"},"Create a bundle"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"import { createBundle } from '@tramvai/core';\nimport { MainPage } from './pages/MainPage';\n\nexport default createBundle({\n  name: 'mainDefault',\n  components: {\n    pageDefault: MainPage,\n  },\n});\n")),(0,o.kt)("h4",{id:"connect-the-bundle"},"Connect the bundle"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"import { createApp } from '@tramvai/core';\n\ncreateApp({\n  name: 'myApp',\n  modules: [\n    // ...\n  ],\n  providers: [\n    // ...\n  ],\n  bundles: {\n    mainDefault: () => import(/* webpackChunkName: \"mainDefault\" */ './bundles/mainDefault'),\n  },\n});\n")))}m.isMDXComponent=!0}}]);