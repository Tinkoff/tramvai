"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8694],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>f});var o=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var u=o.createContext({}),p=function(e){var t=o.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=p(e.components);return o.createElement(u.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},l=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,u=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),l=p(n),f=r,m=l["".concat(u,".").concat(f)]||l[f]||d[f]||a;return n?o.createElement(m,i(i({ref:t},c),{},{components:n})):o.createElement(m,i({ref:t},c))}));function f(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=l;var s={};for(var u in t)hasOwnProperty.call(t,u)&&(s[u]=t[u]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var p=2;p<a;p++)i[p]=n[p];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}l.displayName="MDXCreateElement"},7761:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>u,default:()=>f,frontMatter:()=>s,metadata:()=>p,toc:()=>d});var o=n(7462),r=n(3366),a=(n(7294),n(3905)),i=["components"],s={id:"not-found",title:"Not Found"},u=void 0,p={unversionedId:"features/routing/not-found",id:"features/routing/not-found",title:"Not Found",description:"Usage",source:"@site/tmp-docs/03-features/07-routing/06-not-found.md",sourceDirName:"03-features/07-routing",slug:"/features/routing/not-found",permalink:"/docs/features/routing/not-found",draft:!1,editUrl:"https://github.com/Tinkoff/tramvai/-/edit/master/docs/get-started/overview.md/tmp-docs/03-features/07-routing/06-not-found.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{id:"not-found",title:"Not Found"},sidebar:"sidebar",previous:{title:"Hooks and Guards",permalink:"/docs/features/routing/hooks-and-guards"},next:{title:"Redirects",permalink:"/docs/features/routing/redirects"}},c={},d=[{value:"Usage",id:"usage",level:2},{value:"How To",id:"how-to",level:2},{value:"Change Not Found route response status",id:"change-not-found-route-response-status",level:3},{value:"Trigger Not Found or change response status in actions",id:"trigger-not-found-or-change-response-status-in-actions",level:3},{value:"- Next: Routing - Redirects",id:"--next-routing---redirects",level:5}],l={toc:d};function f(e){var t=e.components,n=(0,r.Z)(e,i);return(0,a.kt)("wrapper",(0,o.Z)({},l,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"usage"},"Usage"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"Not Found")," route used if no matches were found for the current page, can be specified in a special way in the list of routes."),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("p",{parentName:"admonition"},"Working only with ",(0,a.kt)("inlineCode",{parentName:"p"},"pages")," directory and manual routes configuration, File-System Routing not supported for this moment.")),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"path")," property of this route must end in an asterisk - ",(0,a.kt)("inlineCode",{parentName:"p"},"*"),", and can be different for nested paths:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tsx"},"import { SpaRouterModule } from '@tramvai/modules-router';\n\ncreateApp({\n  modules: [\n    SpaRouterModule.forRoot([{\n      name: 'not-found',\n      path: '*',\n      config: {\n        pageComponent: '@/pages/not-found',\n      },\n    }, {\n      name: 'comments-not-found',\n      path: '/comments/*',\n      config: {\n        pageComponent: '@/pages/comments-not-found',\n      },\n    }]),\n  ],\n});\n")),(0,a.kt)("h2",{id:"how-to"},"How To"),(0,a.kt)("h3",{id:"change-not-found-route-response-status"},"Change Not Found route response status"),(0,a.kt)("p",null,"By default, responses for the Not found route return a status of 200. You can change status in custom Route Guard, by using ",(0,a.kt)("inlineCode",{parentName:"p"},"RESPONSE_MANAGER_TOKEN"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"import { provide } from '@tramvai/core';\nimport { ROUTER_GUARD_TOKEN } from '@tramvai/module-router';\nimport { RESPONSE_MANAGER_TOKEN } from '@tramvai/tokens-common';\n\nconst provider = provide({\n  provide: ROUTER_GUARD_TOKEN,\n  useFactory: ({ responseManager }) => {\n    return async ({ to }) => {\n      // watch all navigations, and wait for route with name `not-found`\n      if (to && to.name === 'not-found') {\n        // set the response status, it will be applied until the end of the response\n        responseManager.setStatus(404);\n      }\n    }\n  },\n  deps: {\n    responseManager: RESPONSE_MANAGER_TOKEN,\n  },\n});\n")),(0,a.kt)("h3",{id:"trigger-not-found-or-change-response-status-in-actions"},"Trigger Not Found or change response status in actions"),(0,a.kt)("p",null,"For example, you make a important request in action, and if this request fails, application need to return 500 or 404 status."),(0,a.kt)("p",null,"Page actions running after router navigation flow, when route is completely resolved. You can change status by using ",(0,a.kt)("inlineCode",{parentName:"p"},"RESPONSE_MANAGER_TOKEN"),". If you want to prevent page component rendering, you can throw ",(0,a.kt)("inlineCode",{parentName:"p"},"NotFoundError")," from ",(0,a.kt)("inlineCode",{parentName:"p"},"@tinkoff/errors")," library."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"import { declareAction } from '@tramvai/core';\nimport { NotFoundError } from '@tinkoff/errors';\nimport { RESPONSE_MANAGER_TOKEN } from '@tramvai/tokens-common';\n\nconst pageAction = declareAction({\n  name: 'pageAction',\n  async fn() {\n    const { responseManager } = this.deps;\n\n    try {\n      await fetchSomeData();\n    } catch (e) {\n      if (isCriticalDataError) {\n        // if you throw NotFoundError, Page component will not be rendered, response body will be empty\n        throw new NotFoundError();\n      } else {\n        // otherwise, if you only change response status, Page component will be rendered without neccesary data\n        responseManager.setStatus(500);\n      }\n    }\n  },\n  deps: {\n    responseManager: RESPONSE_MANAGER_TOKEN,\n  },\n});\n")),(0,a.kt)("h5",{id:"--next-routing---redirects"},"- ",(0,a.kt)("a",{parentName:"h5",href:"/docs/features/routing/redirects"},"Next: Routing - Redirects")))}f.isMDXComponent=!0}}]);