"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4322],{3905:(e,t,n)=>{n.d(t,{Zo:()=>s,kt:()=>c});var o=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var u=o.createContext({}),p=function(e){var t=o.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},s=function(e){var t=p(e.components);return o.createElement(u.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,u=e.parentName,s=i(e,["components","mdxType","originalType","parentName"]),d=p(n),c=a,f=d["".concat(u,".").concat(c)]||d[c]||m[c]||r;return n?o.createElement(f,l(l({ref:t},s),{},{components:n})):o.createElement(f,l({ref:t},s))}));function c(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,l=new Array(r);l[0]=d;var i={};for(var u in t)hasOwnProperty.call(t,u)&&(i[u]=t[u]);i.originalType=e,i.mdxType="string"==typeof e?e:a,l[1]=i;for(var p=2;p<r;p++)l[p]=n[p];return o.createElement.apply(null,l)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"},3940:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>u,default:()=>c,frontMatter:()=>i,metadata:()=>p,toc:()=>m});var o=n(7462),a=n(3366),r=(n(7294),n(3905)),l=["components"],i={id:"route-and-components",title:"Route and Components"},u=void 0,p={unversionedId:"features/routing/route-and-components",id:"features/routing/route-and-components",title:"Route and Components",description:"This section describes routes and components relations.",source:"@site/tmp-docs/03-features/07-routing/08-route-and-components.md",sourceDirName:"03-features/07-routing",slug:"/features/routing/route-and-components",permalink:"/docs/features/routing/route-and-components",draft:!1,editUrl:"https://github.com/Tinkoff/tramvai/-/edit/master/docs/get-started/overview.md/tmp-docs/03-features/07-routing/08-route-and-components.md",tags:[],version:"current",sidebarPosition:8,frontMatter:{id:"route-and-components",title:"Route and Components"},sidebar:"sidebar",previous:{title:"Redirects",permalink:"/docs/features/routing/redirects"},next:{title:"How-to",permalink:"/docs/features/routing/how-to"}},s={},m=[{value:"Page structure",id:"page-structure",level:2},{value:"File-System Routing",id:"file-system-routing",level:2},{value:"Manually created routes",id:"manually-created-routes",level:2},{value:"Default components",id:"default-components",level:2},{value:"Bundles (legacy)",id:"bundles-legacy",level:2}],d={toc:m};function c(e){var t=e.components,n=(0,a.Z)(e,l);return(0,r.kt)("wrapper",(0,o.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"This section describes routes and components relations."),(0,r.kt)("h2",{id:"page-structure"},"Page structure"),(0,r.kt)("p",null,"For all application routes, you can specify the list of components names that will be rendered on this route. This list can contain only components keys, whereas according React components will be automatically resolved from special service - ",(0,r.kt)("inlineCode",{parentName:"p"},"ComponentRegistry"),"."),(0,r.kt)("p",null,"List of possible components:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"pageComponent")," - component with ",(0,r.kt)("a",{parentName:"li",href:"/docs/features/pages#page-component"},"page content")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"nestedLayoutComponent")," - component with ",(0,r.kt)("a",{parentName:"li",href:"/docs/features/layouts#nested-layout"},"page layout")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"errorBoundaryComponent")," - component with ",(0,r.kt)("a",{parentName:"li",href:"/docs/features/error-boundaries#page-error-boundary"},"page error boundary")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"layoutComponent")," - component with ",(0,r.kt)("a",{parentName:"li",href:"/docs/features/layouts#root-layout"},"root layout"))),(0,r.kt)("p",null,"Page structure with all components looks like this, simplified:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"const Root = () => (\n  <LayoutComponent>\n    <Header />\n    <NestedLayoutComponent>\n      <ErrorBoundaryComponent>\n        <PageComponent />\n      </ErrorBoundaryComponent>\n    </NestedLayoutComponent>\n    <Footer />\n  </LayoutComponent>\n);\n")),(0,r.kt)("h2",{id:"file-system-routing"},"File-System Routing"),(0,r.kt)("p",null,"For FS routes, route with list of components will be created automatically, and all components will be automatically registered in ",(0,r.kt)("inlineCode",{parentName:"p"},"ComponentRegistry"),"."),(0,r.kt)("p",null,"For example, from this file structure:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"src\n\u2514\u2500\u2500 routes\n    \u251c\u2500\u2500 index.tsx\n    \u251c\u2500\u2500 _layout.tsx\n    \u2514\u2500\u2500 _error.tsx\n")),(0,r.kt)("p",null,"This route will be created:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"[{\n  path: '/',\n  config: {\n    pageComponent: '@/routes/index',\n    nestedLayoutComponent: '@/routes/index__layout',\n    errorBoundaryComponent: '@/routes/index__errorBoundary',\n  },\n}];\n")),(0,r.kt)("h2",{id:"manually-created-routes"},"Manually created routes"),(0,r.kt)("p",null,"For manually created routes, you need to use ",(0,r.kt)("inlineCode",{parentName:"p"},"pages")," directory, all components from this directory will be automatically registered in ",(0,r.kt)("inlineCode",{parentName:"p"},"ComponentRegistry"),"."),(0,r.kt)("p",null,"Example file structure:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"src\n\u2514\u2500\u2500 pages\n    \u251c\u2500\u2500 main.tsx\n    \u251c\u2500\u2500 main-layout.tsx\n    \u2514\u2500\u2500 main-error.tsx\n")),(0,r.kt)("p",null,"And you can create this route with all of this components:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"import { SpaRouterModule } from '@tramvai/modules-router';\n\ncreateApp({\n  modules: [\n    SpaRouterModule.forRoot([{\n      name: 'main',\n      path: '/',\n      config: {\n        pageComponent: '@/pages/main',\n        nestedLayoutComponent: '@/pages/main-layout',\n        errorBoundaryComponent: '@/pages/main-error',\n      },\n    }]),\n  ],\n});\n")),(0,r.kt)("h2",{id:"default-components"},"Default components"),(0,r.kt)("p",null,"For all components can be specified default component, e.g. that keys will be used if component with specified in route config key is not found in ",(0,r.kt)("inlineCode",{parentName:"p"},"ComponentRegistry"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"const mapping = {\n  pageComponent: 'pageDefault',\n  nestedLayoutComponent: 'nestedLayoutDefault',\n  errorBoundaryComponent: 'errorBoundaryDefault',\n  layoutComponent: 'layoutDefault',\n}\n")),(0,r.kt)("p",null,"Default Root Layout already provided by token ",(0,r.kt)("inlineCode",{parentName:"p"},"DEFAULT_LAYOUT_COMPONENT"),", this is default ",(0,r.kt)("a",{parentName:"p",href:"/docs/features/layouts#root-layout"},"application layout")," and it is not recommended to change it."),(0,r.kt)("p",null,"Default Page Error Boundary can be provided by token ",(0,r.kt)("a",{parentName:"p",href:"/docs/features/error-boundaries#default-fallback"},(0,r.kt)("inlineCode",{parentName:"a"},"DEFAULT_ERROR_BOUNDARY_COMPONENT")),"."),(0,r.kt)("p",null,"Default Page Nested Layout is not supported for FS routes or pages and is not necessary, because Root ",(0,r.kt)("a",{parentName:"p",href:"/docs/features/layouts#components-and-wrappers"},(0,r.kt)("inlineCode",{parentName:"a"},"LAYOUT_OPTIONS"))," is more powerful mechanism - ",(0,r.kt)("inlineCode",{parentName:"p"},"wrappers.page")," is complete alternative for nested layout in page components hierarchy."),(0,r.kt)("p",null,"Default Page Component is not supported for FS routes or pages, only for ",(0,r.kt)("a",{parentName:"p",href:"#bundles-legacy"},"legacy bundles"),"."),(0,r.kt)("h2",{id:"bundles-legacy"},"Bundles (legacy)"),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Bundles is legacy feature, and it is recommended to use File-System routing in new projects.")),(0,r.kt)("p",null,"For ",(0,r.kt)("a",{parentName:"p",href:"/docs/concepts/bundle"},"bundles")," situation is more complicated, because bundles can group several components, and different routes can use the same bundle. Also, it means that for bundles additional level of default components will be used."),(0,r.kt)("p",null,"Important default for routes if bundles is used, is default bundle and page component keys:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"const routeConfig = {\n  bundle: 'mainDefault',\n  pageComponent: 'pageDefault',\n};\n")),(0,r.kt)("p",null,"It means that all routes without FS routing will use ",(0,r.kt)("inlineCode",{parentName:"p"},"mainDefault")," bundle, and get ",(0,r.kt)("inlineCode",{parentName:"p"},"pageDefault")," page component from this bundle. Example of this default bundle:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="bundles/mainDefault.ts"',title:'"bundles/mainDefault.ts"'},"import { createBundle } from '@tramvai/core';\nimport { lazy } from '@tramvai/react';\n\nexport const mainDefault = createBundle({\n  name: 'mainDefault',\n  components: {\n    pageDefault: lazy(() => import('../components/main-page')),\n  },\n});\n")),(0,r.kt)("p",null,"And for this simple route, ",(0,r.kt)("inlineCode",{parentName:"p"},"components/main-page.tsx")," page component will be rendered:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"import { SpaRouterModule } from '@tramvai/modules-router';\n\ncreateApp({\n  modules: [\n    SpaRouterModule.forRoot([{\n      name: 'main',\n      path: '/',\n    }]),\n  ],\n  bundles: {\n    mainDefault: () => import(/* webpackChunkName: \"mainDefault\" */ './bundles/mainDefault'),\n  },\n});\n")),(0,r.kt)("p",null,"All other default components will applied to route with this bundle, e.g.:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="bundles/mainDefault.ts"',title:'"bundles/mainDefault.ts"'},"import { createBundle } from '@tramvai/core';\nimport { lazy } from '@tramvai/react';\n\nexport const mainDefault = createBundle({\n  name: 'mainDefault',\n  components: {\n    pageDefault: lazy(() => import('../components/main-page')),\n    // highlight-next-line\n    nestedLayoutDefault: lazy(() => import('../components/main-layout')),\n    // highlight-next-line\n    errorBoundaryDefault: lazy(() => import('../components/main-error')),\n    // highlight-next-line\n    layoutDefault: lazy(() => import('../components/layout')),\n  },\n});\n")),(0,r.kt)("p",null,"Defaults from ",(0,r.kt)("a",{parentName:"p",href:"#default-components"},"Defaults components")," section also will be applied, but with lower priority."),(0,r.kt)("p",null,"In summary:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"If ",(0,r.kt)("inlineCode",{parentName:"li"},"pageComponent"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"layoutComponent"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"nestedLayoutComponent")," or ",(0,r.kt)("inlineCode",{parentName:"li"},"errorBoundaryComponent")," properties is specified in route config, they values will be used as components keys"),(0,r.kt)("li",{parentName:"ul"},"Otherwise, ",(0,r.kt)("inlineCode",{parentName:"li"},"pageDefault"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"layoutDefault"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"nestedLayoutDefault")," or ",(0,r.kt)("inlineCode",{parentName:"li"},"errorBoundaryDefault")," will be used as components keys"),(0,r.kt)("li",{parentName:"ul"},"Then, if current bundle components has component with this key, it will be used"),(0,r.kt)("li",{parentName:"ul"},"Otherwise, ",(0,r.kt)("inlineCode",{parentName:"li"},"tramvai")," will try to find this keys in default components"),(0,r.kt)("li",{parentName:"ul"},"Only for Page Component, if it is not found anywhere, 500 error will be thrown")))}c.isMDXComponent=!0}}]);