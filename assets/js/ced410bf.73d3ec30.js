"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4325],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>u});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var p=n.createContext({}),d=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},c=function(e){var t=d(e.components);return n.createElement(p.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,p=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),m=d(a),u=r,h=m["".concat(p,".").concat(u)]||m[u]||s[u]||i;return a?n.createElement(h,o(o({ref:t},c),{},{components:a})):n.createElement(h,o({ref:t},c))}));function u(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=m;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var d=2;d<i;d++)o[d]=a[d];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},1718:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>p,default:()=>u,frontMatter:()=>l,metadata:()=>d,toc:()=>s});var n=a(7462),r=a(3366),i=(a(7294),a(3905)),o=["components"],l={id:"how-create-child-app",title:"How to create Child App?"},p=void 0,d={unversionedId:"how-to/how-create-child-app",id:"how-to/how-create-child-app",title:"How to create Child App?",description:"Initialization",source:"@site/tmp-docs/how-to/how-create-child-app.md",sourceDirName:"how-to",slug:"/how-to/how-create-child-app",permalink:"/docs/how-to/how-create-child-app",draft:!1,editUrl:"https://github.com/Tinkoff/tramvai/-/edit/master/docs/get-started/overview.md/tmp-docs/how-to/how-create-child-app.md",tags:[],version:"current",frontMatter:{id:"how-create-child-app",title:"How to create Child App?"},sidebar:"sidebar",previous:{title:"How to create a bundle?",permalink:"/docs/how-to/how-create-bundle"},next:{title:"How to create a module?",permalink:"/docs/how-to/how-create-module"}},c={},s=[{value:"Initialization",id:"initialization",level:2},{value:"@tramvai/cli",id:"tramvaicli",level:3},{value:"Step By Step",id:"step-by-step",level:3},{value:"Development",id:"development",level:2},{value:"Add new functionality",id:"add-new-functionality",level:3},{value:"Testing",id:"testing",level:3},{value:"Unit",id:"unit",level:4},{value:"Integration Tests",id:"integration-tests",level:4},{value:"Deploy",id:"deploy",level:3}],m={toc:s};function u(e){var t=e.components,a=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,n.Z)({},m,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"initialization"},"Initialization"),(0,i.kt)("h3",{id:"tramvaicli"},"@tramvai/cli"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Run in your shell")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"tramvai new [name]\n")),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Choose ",(0,i.kt)("inlineCode",{parentName:"li"},"Microfrontend implemented by tramvai child-app")),(0,i.kt)("li",{parentName:"ol"},"Follow next steps of setup based on your needs")),(0,i.kt)("p",null,"After that in directory ",(0,i.kt)("inlineCode",{parentName:"p"},"[name]")," will be generated new child-app from template with all necessary setup."),(0,i.kt)("p",null,"You can use commands ",(0,i.kt)("inlineCode",{parentName:"p"},"tramvai start/tramvai build")," to start/build your new child-app."),(0,i.kt)("h3",{id:"step-by-step"},"Step By Step"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Create new repo")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Init package-manager")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add necessarily package for child app"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"  yarn add --dev @tramvai/cli\n  yarn add @tramvai/child-app-core\n"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Create new file ",(0,i.kt)("inlineCode",{parentName:"p"},"tramvai.json")," in the root with following content"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "$schema": "./node_modules/@tramvai/cli/schema.json",\n  "projects": {\n    "[name]": {\n      "name": "[name]",\n      "root": "src",\n      "type": "child-app"\n    }\n  }\n}\n'))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add scripts to ",(0,i.kt)("inlineCode",{parentName:"p"},"package.json")," for run child in dev and prod mode:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "scripts": {\n    "start": "tramvai start [name]",\n    "build": "tramvai build [name]"\n  }\n}\n'))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Implement your React-component wrapper (for example in ",(0,i.kt)("inlineCode",{parentName:"p"},"./src/component.tsx"),")")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add new file ",(0,i.kt)("inlineCode",{parentName:"p"},"./src/entry.ts")," for you app with following content:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"import { createChildApp } from '@tramvai/child-app-core';\nimport { ChildAppComponent } from './component';\n\n// eslint-disable-next-line import/no-default-export\nexport default createChildApp({\n  name: '[name]',\n  modules: [],\n  render: ChildAppComponent,\n});\n")))),(0,i.kt)("h2",{id:"development"},"Development"),(0,i.kt)("h3",{id:"add-new-functionality"},"Add new functionality"),(0,i.kt)("p",null,"Child App should mostly reuse functionality from root app through di inheritance (it happens automatically) in cases when it is appropriate. But in order to properly work, some of the modules need a special wrapper module for child app (usually such a wrapper is needed when module functionality in used in React). In this case check interested module documentation on presence of such a wrapper module for a child app."),(0,i.kt)("p",null,"If your child app has some specific functionality you may implement it the way you want: through module, provider, actions or inside React-component. Just make sure you are reusing as much functionality from root app as possible and you are adding as little code as needed to produce smallest possible child-app script."),(0,i.kt)("h3",{id:"testing"},"Testing"),(0,i.kt)("h4",{id:"unit"},"Unit"),(0,i.kt)("p",null,"You may use helper library ",(0,i.kt)("a",{parentName:"p",href:"/docs/references/tramvai/test/child-app"},"@tramvai/test-child-app")," that creates mock application in order to test child-app behaviour in the app."),(0,i.kt)("h4",{id:"integration-tests"},"Integration Tests"),(0,i.kt)("p",null,"Full testing requires to run standalone app that will reuse your app."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Create test app in your repository. Also you may use ",(0,i.kt)("inlineCode",{parentName:"li"},"@tramvai/test-trandapp")," for generating simple app without hassle (not yet available in open-source)."),(0,i.kt)("li",{parentName:"ol"},"Using ",(0,i.kt)("a",{parentName:"li",href:"/docs/references/tramvai/test/integration"},"@tramvai/test-integration")," and ",(0,i.kt)("a",{parentName:"li",href:"/docs/references/tramvai/test/playwright"},"@tramvai/test-pw")," you may perform any kind of tests including testing in browser.")),(0,i.kt)("h3",{id:"deploy"},"Deploy"),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Child-app is built ignoring ",(0,i.kt)("inlineCode",{parentName:"p"},"modern")," option in tramvai config. This is because we don't know the actual environment that will load the child-app and this environment may require legacy support")),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Build your child-app with command ",(0,i.kt)("inlineCode",{parentName:"li"},"tramvai build [name]")),(0,i.kt)("li",{parentName:"ol"},"Copy generated files from ",(0,i.kt)("inlineCode",{parentName:"li"},"./dist/child-app")," (by default) to the external cdn"),(0,i.kt)("li",{parentName:"ol"},"Provide link to the cdn itself through token ",(0,i.kt)("inlineCode",{parentName:"li"},"CHILD_APP_RESOLVE_BASE_URL_TOKEN")," or env ",(0,i.kt)("inlineCode",{parentName:"li"},"CHILD_APP_EXTERNAL_URL"))))}u.isMDXComponent=!0}}]);