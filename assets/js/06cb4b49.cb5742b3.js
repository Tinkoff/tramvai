"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6605],{3905:(e,t,r)=>{r.d(t,{Zo:()=>c,kt:()=>m});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var p=n.createContext({}),u=function(e){var t=n.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},c=function(e){var t=u(e.components);return n.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},s=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,p=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),s=u(r),m=a,y=s["".concat(p,".").concat(m)]||s[m]||d[m]||o;return r?n.createElement(y,i(i({ref:t},c),{},{components:r})):n.createElement(y,i({ref:t},c))}));function m(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,i=new Array(o);i[0]=s;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var u=2;u<o;u++)i[u]=r[u];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}s.displayName="MDXCreateElement"},1536:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>p,default:()=>m,frontMatter:()=>l,metadata:()=>u,toc:()=>d});var n=r(7462),a=r(3366),o=(r(7294),r(3905)),i=["components"],l={id:"react-query",title:"React Query"},p=void 0,u={unversionedId:"features/child-app/advanced/react-query",id:"features/child-app/advanced/react-query",title:"React Query",description:"React Query integration works the same way as Root App integration",source:"@site/tmp-docs/03-features/015-child-app/012-advanced/03-react-query.md",sourceDirName:"03-features/015-child-app/012-advanced",slug:"/features/child-app/advanced/react-query",permalink:"/docs/features/child-app/advanced/react-query",draft:!1,editUrl:"https://github.com/Tinkoff/tramvai/-/edit/master/docs/get-started/overview.md/tmp-docs/03-features/015-child-app/012-advanced/03-react-query.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{id:"react-query",title:"React Query"},sidebar:"sidebar",previous:{title:"Module Federation (shared dependencies)",permalink:"/docs/features/child-app/advanced/module-federation"},next:{title:"Error Handling",permalink:"/docs/features/child-app/advanced/error-handling"}},c={},d=[{value:"Installation",id:"installation",level:2},{value:"Usage",id:"usage",level:2},{value:"Create query",id:"create-query",level:3},{value:"Use query",id:"use-query",level:3},{value:"Prefetch query",id:"prefetch-query",level:3},{value:"Tips",id:"tips",level:2},{value:"Bundle Size",id:"bundle-size",level:3}],s={toc:d};function m(e){var t=e.components,r=(0,a.Z)(e,i);return(0,o.kt)("wrapper",(0,n.Z)({},s,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"React Query integration works the same way as ",(0,o.kt)("a",{parentName:"p",href:"/docs/features/data-fetching/react-query"},"Root App integration")),(0,o.kt)("h2",{id:"installation"},"Installation"),(0,o.kt)("p",null,"First, you need to install ",(0,o.kt)("inlineCode",{parentName:"p"},"@tramvai/module-react-query")," module in your Child App:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"npx tramvai add @tramvai/module-react-query\n")),(0,o.kt)("p",null,"Then, connect ",(0,o.kt)("inlineCode",{parentName:"p"},"ReactQueryModule")," from this module in your ",(0,o.kt)("inlineCode",{parentName:"p"},"createChildApp")," function:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"import { createChildApp } from '@tramvai/child-app-core';\nimport { CommonChildAppModule } from '@tramvai/module-common';\nimport { ReactQueryModule } from '@tramvai/module-react-query';\nimport { RootCmp } from './components/root';\n\n// eslint-disable-next-line import/no-default-export\nexport default createChildApp({\n  name: 'fancy-child',\n  render: RootCmp,\n  modules: [CommonChildAppModule, ReactQueryModule],\n  providers: [],\n});\n")),(0,o.kt)("h2",{id:"usage"},"Usage"),(0,o.kt)("p",null,"React Query usage consists of 3 steps:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"creation"),(0,o.kt)("li",{parentName:"ul"},"usage in component"),(0,o.kt)("li",{parentName:"ul"},"prefetching with Child App preloading")),(0,o.kt)("h3",{id:"create-query"},"Create query"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"import { createQuery } from '@tramvai/react-query';\nimport { HTTP_CLIENT } from '@tramvai/tokens-http-client';\n\nexport const query = createQuery({\n  key: 'base',\n  fn: async (_, { apiClient }) => {\n    const { payload } = await apiClient.get<string>('api/example');\n\n    return payload;\n  },\n  deps: {\n    httpClient: HTTP_CLIENT,\n  },\n});\n")),(0,o.kt)("h3",{id:"use-query"},"Use query"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'title="components/root.tsx"',title:'"components/root.tsx"'},"import { useQuery } from '@tramvai/react-query';\nimport { query } from './query';\n\nexport const RootCmp = () => {\n  const { data, isLoading } = useQuery(query);\n\n  return <div>{isLoading ? 'loading...' : data}</div>;\n};\n")),(0,o.kt)("h3",{id:"prefetch-query"},"Prefetch query"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"import { createChildApp } from '@tramvai/child-app-core';\nimport { CommonChildAppModule } from '@tramvai/module-common';\nimport { ReactQueryModule } from '@tramvai/module-react-query';\nimport { RootCmp } from './components/root';\nimport { query } from './query';\n\n// eslint-disable-next-line import/no-default-export\nexport default createChildApp({\n  name: 'fancy-child',\n  render: RootCmp,\n  modules: [CommonChildAppModule, ReactQueryModule],\n  providers: [],\n  // highlight-next-line\n  actions: [query.prefetchAction()],\n});\n")),(0,o.kt)("h2",{id:"tips"},"Tips"),(0,o.kt)("h3",{id:"bundle-size"},"Bundle Size"),(0,o.kt)("p",null,"For example, you will use React Query in Root App and few Child Apps in same page. In this case, total JS amount will be increased significantly."),(0,o.kt)("p",null,"To avoid this, you can share React Query libraries through ",(0,o.kt)("a",{parentName:"p",href:"/docs/features/child-app/advanced/module-federation"},"Module Federation")))}m.isMDXComponent=!0}}]);