"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1813],{3905:(e,o,t)=>{t.d(o,{Zo:()=>c,kt:()=>u});var n=t(7294);function r(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}function i(e,o){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);o&&(n=n.filter((function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable}))),t.push.apply(t,n)}return t}function s(e){for(var o=1;o<arguments.length;o++){var t=null!=arguments[o]?arguments[o]:{};o%2?i(Object(t),!0).forEach((function(o){r(e,o,t[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(t,o))}))}return e}function a(e,o){if(null==e)return{};var t,n,r=function(e,o){if(null==e)return{};var t,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)t=i[n],o.indexOf(t)>=0||(r[t]=e[t]);return r}(e,o);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],o.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var l=n.createContext({}),p=function(e){var o=n.useContext(l),t=o;return e&&(t="function"==typeof e?e(o):s(s({},o),e)),t},c=function(e){var o=p(e.components);return n.createElement(l.Provider,{value:o},e.children)},d={inlineCode:"code",wrapper:function(e){var o=e.children;return n.createElement(n.Fragment,{},o)}},k=n.forwardRef((function(e,o){var t=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,c=a(e,["components","mdxType","originalType","parentName"]),k=p(t),u=r,h=k["".concat(l,".").concat(u)]||k[u]||d[u]||i;return t?n.createElement(h,s(s({ref:o},c),{},{components:t})):n.createElement(h,s({ref:o},c))}));function u(e,o){var t=arguments,r=o&&o.mdxType;if("string"==typeof e||r){var i=t.length,s=new Array(i);s[0]=k;var a={};for(var l in o)hasOwnProperty.call(o,l)&&(a[l]=o[l]);a.originalType=e,a.mdxType="string"==typeof e?e:r,s[1]=a;for(var p=2;p<i;p++)s[p]=t[p];return n.createElement.apply(null,s)}return n.createElement.apply(null,t)}k.displayName="MDXCreateElement"},474:(e,o,t)=>{t.r(o),t.d(o,{frontMatter:()=>a,contentTitle:()=>l,metadata:()=>p,toc:()=>c,default:()=>k});var n=t(3117),r=t(102),i=(t(7294),t(3905)),s=["components"],a={id:"hooks",title:"hooks"},l=void 0,p={unversionedId:"references/libs/hooks",id:"references/libs/hooks",title:"hooks",description:"Library used for subscription on specific events in different styles: sync, async, promise.",source:"@site/tmp-docs/references/libs/hooks.md",sourceDirName:"references/libs",slug:"/references/libs/hooks",permalink:"/en/docs/references/libs/hooks",editUrl:"https://github.com/Tinkoff/tramvai/-/edit/master/docs/get-started/overview.md/tmp-docs/references/libs/hooks.md",tags:[],version:"current",frontMatter:{id:"hooks",title:"hooks"},sidebar:"docs",previous:{title:"eslint-plugin-tramvai",permalink:"/en/docs/references/libs/eslint-plugin-tramvai"},next:{title:"express-terminus",permalink:"/en/docs/references/libs/express-terminus"}},c=[{value:"Explanation",id:"explanation",children:[{value:"Caveats",id:"caveats",children:[],level:3}],level:2},{value:"API",id:"api",children:[{value:"Hooks",id:"hooks",children:[],level:4},{value:"registerHooks(key, hooks)",id:"registerhookskey-hooks",children:[],level:4},{value:"runHooks(key, context, payload, options)",id:"runhookskey-context-payload-options",children:[],level:4},{value:"runAsyncHooks(key, context, payload, options)",id:"runasynchookskey-context-payload-options",children:[],level:4},{value:"runPromiseHooks(key, context, options) =&gt; (payload) =&gt; Promise",id:"runpromisehookskey-context-options--payload--promise",children:[],level:4}],level:2},{value:"Hooks",id:"hooks-1",children:[{value:"Types",id:"types",children:[{value:"sync",id:"sync",children:[],level:4},{value:"async",id:"async",children:[],level:4},{value:"promise",id:"promise",children:[],level:4}],level:3}],level:2}],d={toc:c};function k(e){var o=e.components,t=(0,r.Z)(e,s);return(0,i.kt)("wrapper",(0,n.Z)({},d,t,{components:o,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Library used for subscription on specific events in different styles: sync, async, promise."),(0,i.kt)("h2",{id:"explanation"},"Explanation"),(0,i.kt)("p",null,"Working with lib consist of two phases:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Adding in the target code hook runner call, e.g. ",(0,i.kt)("inlineCode",{parentName:"li"},"runAsyncHooks"),", with unique event key and additional parameters. It creates a slot for this event that allow to subscribe on the event."),(0,i.kt)("li",{parentName:"ol"},"Registering hook handler with ",(0,i.kt)("inlineCode",{parentName:"li"},"registerHooks")," that will be executed when ",(0,i.kt)("inlineCode",{parentName:"li"},"run...")," function will be called")),(0,i.kt)("h3",{id:"caveats"},"Caveats"),(0,i.kt)("p",null,"There is different types hooks that are not interoperable. So carefully add new registrations with checking expected hook type."),(0,i.kt)("p",null,"Also you should preserve data chain, e.g. return data with same interface from hook, as it otherwise may break other hooks."),(0,i.kt)("h2",{id:"api"},"API"),(0,i.kt)("h4",{id:"hooks"},"Hooks"),(0,i.kt)("p",null,"Create new instance of ",(0,i.kt)("inlineCode",{parentName:"p"},"@tinkoff/hook-runner")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"import { Hooks } from '@tinkoff/hook-runner';\n\nconst hookRunner = new Hooks();\n")),(0,i.kt)("h4",{id:"registerhookskey-hooks"},"registerHooks(key, hooks)"),(0,i.kt)("p",null,"Register new hook for a specific key."),(0,i.kt)("h4",{id:"runhookskey-context-payload-options"},"runHooks(key, context, payload, options)"),(0,i.kt)("p",null,"Execute sync hooks. ",(0,i.kt)("inlineCode",{parentName:"p"},"payload")," is passed through every hook and will be returned as a result (it may be changed by hooks)."),(0,i.kt)("h4",{id:"runasynchookskey-context-payload-options"},"runAsyncHooks(key, context, payload, options)"),(0,i.kt)("p",null,"Executes async hooks using setTimeout. ",(0,i.kt)("inlineCode",{parentName:"p"},"payload")," is passed to every hook with its initial value."),(0,i.kt)("h4",{id:"runpromisehookskey-context-options--payload--promise"},"runPromiseHooks(key, context, options) => (payload) => Promise"),(0,i.kt)("p",null,"Execute promise-based hooks. ",(0,i.kt)("inlineCode",{parentName:"p"},"payload")," is passed through every hook and will be returned as a result (it may be changed by hooks)"),(0,i.kt)("h2",{id:"hooks-1"},"Hooks"),(0,i.kt)("h3",{id:"types"},"Types"),(0,i.kt)("h4",{id:"sync"},"sync"),(0,i.kt)("p",null,"Accepts (context, payload, options). Hooks are running in order passing previous hook result as input for next hook."),(0,i.kt)("h4",{id:"async"},"async"),(0,i.kt)("p",null,"Accepts (context, payload, options). Hooks are running independently from each other."),(0,i.kt)("h4",{id:"promise"},"promise"),(0,i.kt)("p",null,"Accepts (context, payload, options). Hooks are running in order passing previous hook result as input for next hook with wrapping call in promise."))}k.isMDXComponent=!0}}]);